# Minimal OpenSIPS config: forward REGISTER and INVITE to Asterisk on the ivrnet
# This is intentionally small for testing â€” adapt security and features for production.

# listen on all addresses
listen=udp:0.0.0.0:5060

# load minimal modules
loadmodule "db_mysql.so"
loadmodule "sl.so"
loadmodule "tm.so"
loadmodule "usrloc.so"
loadmodule "registrar.so"
loadmodule "rr.so"

# module parameters (none required for this minimal config)

# request route
route{
    if(is_method("REGISTER")){
        save("location");
        exit;
    }

    if(is_method("INVITE")){
        # forward INVITE to Asterisk on the ivrnet
        route(RELAY_TO_ASTERISK);
        exit;
    }

    route(RELAY_TO_ASTERISK);
}

route[RELAY_TO_ASTERISK]{
    t_relay("sip:asterisk:5060");
}

# reply route
onreply_route{
    t_relay();
}
